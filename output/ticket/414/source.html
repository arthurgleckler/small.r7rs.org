
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Copyright 2013 by Arthur A. Gleckler. All rights reserved. -->
    <title>Source for ticket #414</title>
    <link href="/trac.css" rel="stylesheet" type="text/css"></head>
  <body>
    <header>This site is a static rendering of the <a href="https://trac.edgewall.org/">Trac</a> instance that was used by <a href="http://scheme-reports.org/2015/working-group-1.html">R7RS-WG1</a> for its work on R7RS-small (<a href="/attachment/r7rs.pdf">PDF</a>), which was ratified in 2013. For more information, see <a href="/">Home</a>.</header>
    <ul class="navigation">
      <li><a href="/">Home</a></li>
      <li><a href="/ticket/">All tickets</a></li>
      <li><a href="/wiki/">All wiki pages</a></li></ul>
    <h1>Source for ticket #414</h1>
    <h2>cc</h2>
    <pre></pre>
    <h2>changetime</h2>
    <pre>2012-06-28 10:59:45</pre>
    <h2>component</h2>
    <pre>WG1 - Core</pre>
    <h2>description</h2>
    <pre>Submitter's Name: Jussi Piitulainen

Submitter's Email Address: jpiitula at ling dot helsinki dot fi

Draft Version of Report: 6th

Summary: Internal syntax definitions vs a body with definitions being a letrec*

Full Description:


I desire a clarification on how a body that begins with internal definitions can be equivalent to a `letrec*` when syntax definitions are valid wherever definitions are.

The coverage of the related issues in the report has improved much since I last read it. I'm still not quite satisfied about this particular issue: the report seems to me to be silent, or at best much more implicit than I like, about how a body like the following is equivalent to a `letrec*`. There is no room in a `letrec*` for the syntax definition:


{{{
(lambda () ;say
   (define (f x) ...)   ;the body begins
   (define-syntax ...)
   (f ...))
}}}

If there is a sentence or two that would make the intent of the authors explicit, please add them to the report (in 5.2.2 where the crucial statement of the equivalence is made). Possibly it is something about an &quot;expanded body&quot; not containing the syntax-definitions any more, but I feel like I'm guessing here and looking for some statement that is not there in the report.

I'm concerned because I like the equivalence and wish it to be true.

Relevant sites in the report follow (and a couple of related lesser concerns that turn up when I was investigate this, but it is the issue above that I formally wish to be clarified).


4.2.3 Sequencing (p. 16)

`(begin &lt;expression or definition&gt; ...)` may appear as part of a `&lt;body&gt;`, [...] rationale: [macro output]

5.2 Definitions (p. 23 bottom right)

... valid ... at the _beginning_ of a `&lt;body&gt;`. [my emphasis]

5.2.2 Internal definitions (p. 24 right, mid-section)

An expanded `&lt;body&gt;` containing internal definitions can always be
converted into a completely equivalent `letrec*` expressions.

5.3 Syntax definitions (p. 25 top left)

Syntax definitions are valid wherever definitions are.

7.1.3 Expressions (p. 58 right)

`&lt;body&gt; --&gt; &lt;definition&gt;* &lt;sequence&gt;`

7.1.6 Programs and definitions (p. 60 left)

`&lt;definition&gt; --&gt; ... | &lt;syntax definition&gt; | ...`

Finally, I still have a related concern about `&lt;body&gt;`: the entry on lambda expressions does not tell the truth about `&lt;body&gt;` allowing internal definitions, yet several binding constructs refer to it as being authoritative about `&lt;body&gt;`:

4.1.4 Procedures (p. 12 bottom right)

... `&lt;body&gt;` should be a sequence of one or more expressions.  [this does not allow internal definitions]

4.2.4 Binding constructs (p. 15-16)

... `&lt;body&gt;` should be a sequence of zero or more expressions followed by a sequence of one or more expressions as described in section 4.1.4. ... [this appears in every binding construct and is fine]

Finally finally, &quot;body&quot; is not an index entry (p. 77) and it should be. Probably it should point to 4.1.4 but, as noted above, that site does not tell the truth about `&lt;body&gt;`, or body, and maybe to 5.2.2, where I'm formally seeking clarification. Thank you for your attention.
</pre>
    <h2>id</h2>
    <pre>414</pre>
    <h2>keywords</h2>
    <pre></pre>
    <h2>milestone</h2>
    <pre></pre>
    <h2>owner</h2>
    <pre>cowan</pre>
    <h2>priority</h2>
    <pre>major</pre>
    <h2>reporter</h2>
    <pre>cowan</pre>
    <h2>resolution</h2>
    <pre>fixed</pre>
    <h2>severity</h2>
    <pre></pre>
    <h2>status</h2>
    <pre>closed</pre>
    <h2>summary</h2>
    <pre>Formal Comment: Internal syntax definitions vs a body with definitions being a letrec*</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:33:54</pre>
    <h2>type</h2>
    <pre>defect</pre>
    <h1>Changes</h1>
    <h2>Change at time 2012-06-28 10:59:45</h2>
    <h2>author</h2>
    <pre>cowan</pre>
    <h2>field</h2>
    <pre>comment</pre>
    <h2>newvalue</h2>
    <pre>Formal response sent.</pre>
    <h2>oldvalue</h2>
    <pre>2</pre>
    <h2>raw-time</h2>
    <pre>1340855985621933</pre>
    <h2>ticket</h2>
    <pre>414</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:59:45</pre>
    <h2>Change at time 2012-06-28 10:59:45</h2>
    <h2>author</h2>
    <pre>cowan</pre>
    <h2>field</h2>
    <pre>resolution</pre>
    <h2>newvalue</h2>
    <pre>fixed</pre>
    <h2>oldvalue</h2>
    <pre></pre>
    <h2>raw-time</h2>
    <pre>1340855985621933</pre>
    <h2>ticket</h2>
    <pre>414</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:59:45</pre>
    <h2>Change at time 2012-06-28 10:59:45</h2>
    <h2>author</h2>
    <pre>cowan</pre>
    <h2>field</h2>
    <pre>status</pre>
    <h2>newvalue</h2>
    <pre>closed</pre>
    <h2>oldvalue</h2>
    <pre>accepted</pre>
    <h2>raw-time</h2>
    <pre>1340855985621933</pre>
    <h2>ticket</h2>
    <pre>414</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:59:45</pre>
    <h2>Change at time 2012-06-28 10:34:09</h2>
    <h2>author</h2>
    <pre>cowan</pre>
    <h2>field</h2>
    <pre>comment</pre>
    <h2>newvalue</h2>
    <pre></pre>
    <h2>oldvalue</h2>
    <pre>1</pre>
    <h2>raw-time</h2>
    <pre>1340854449977069</pre>
    <h2>ticket</h2>
    <pre>414</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:34:09</pre>
    <h2>Change at time 2012-06-28 10:34:09</h2>
    <h2>author</h2>
    <pre>cowan</pre>
    <h2>field</h2>
    <pre>owner</pre>
    <h2>newvalue</h2>
    <pre>cowan</pre>
    <h2>oldvalue</h2>
    <pre>alexshinn</pre>
    <h2>raw-time</h2>
    <pre>1340854449977069</pre>
    <h2>ticket</h2>
    <pre>414</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:34:09</pre>
    <h2>Change at time 2012-06-28 10:34:09</h2>
    <h2>author</h2>
    <pre>cowan</pre>
    <h2>field</h2>
    <pre>status</pre>
    <h2>newvalue</h2>
    <pre>accepted</pre>
    <h2>oldvalue</h2>
    <pre>new</pre>
    <h2>raw-time</h2>
    <pre>1340854449977069</pre>
    <h2>ticket</h2>
    <pre>414</pre>
    <h2>time</h2>
    <pre>2012-06-28 10:34:09</pre></body></html>